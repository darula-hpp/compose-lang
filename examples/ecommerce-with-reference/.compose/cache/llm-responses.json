{
  "2217c8c7686f16a27320830f67210cc5f3e1be42202b0fc7a97f438914cf7ada": "### FILE: package.json\n{\n  \"name\": \"my-shop\",\n  \"version\": \"0.1.0\",\n  \"private\": true,\n  \"scripts\": {\n    \"dev\": \"next dev\",\n    \"build\": \"next build\",\n    \"start\": \"next start\",\n    \"lint\": \"next lint\"\n  },\n  \"dependencies\": {\n    \"autoprefixer\": \"^10.4.19\",\n    \"date-fns\": \"^3.6.0\",\n    \"next\": \"14.2.3\",\n    \"next-themes\": \"^0.3.0\",\n    \"postcss\": \"^8.4.38\",\n    \"react\": \"^18.3.1\",\n    \"react-dom\": \"^18.3.1\",\n    \"tailwindcss\": \"^3.4.3\",\n    \"typescript\": \"^5.4.5\"\n  },\n  \"devDependencies\": {\n    \"@types/node\": \"^20.12.12\",\n    \"@types/react\": \"^18.3.2\",\n    \"@types/react-dom\": \"^18.3.0\",\n    \"eslint\": \"^8.57.0\",\n    \"eslint-config-next\": \"14.2.3\"\n  }\n}\n\n### FILE: tsconfig.json\n{\n  \"compilerOptions\": {\n    \"lib\": [\"dom\", \"dom.iterable\", \"esnext\"],\n    \"allowJs\": true,\n    \"skipLibCheck\": true,\n    \"strict\": true,\n    \"noEmit\": true,\n    \"esModuleInterop\": true,\n    \"module\": \"esnext\",\n    \"moduleResolution\": \"bundler\",\n    \"resolveJsonModule\": true,\n    \"isolatedModules\": true,\n    \"jsx\": \"preserve\",\n    \"incremental\": true,\n    \"plugins\": [\n      {\n        \"name\": \"next\"\n      }\n    ],\n    \"paths\": {\n      \"@/*\": [\"./*\"]\n    }\n  },\n  \"include\": [\"next-env.d.ts\", \"**/*.ts\", \"**/*.tsx\", \".next/types/**/*.ts\"],\n  \"exclude\": [\"node_modules\"]\n}\n\n### FILE: next.config.mjs\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  reactStrictMode: true,\n};\n\nexport default nextConfig;\n\n### FILE: tailwind.config.ts\nimport type { Config } from 'tailwindcss';\n\nconst config: Config = {\n  darkMode: 'class', // Enable dark mode based on 'class'\n  content: [\n    './pages/**/*.{js,ts,jsx,tsx,mdx}',\n    './components/**/*.{js,ts,jsx,tsx,mdx}',\n    './app/**/*.{js,ts,jsx,tsx,mdx}',\n  ],\n  theme: {\n    extend: {\n      backgroundImage: {\n        'gradient-radial': 'radial-gradient(var(--tw-gradient-stops))',\n        'gradient-conic':\n          'conic-gradient(from 180deg at 50% 50%, var(--tw-gradient-stops))',\n      },\n    },\n  },\n  plugins: [],\n};\nexport default config;\n\n### FILE: postcss.config.js\nmodule.exports = {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n};\n\n### FILE: app/globals.css\n@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n@layer base {\n  body {\n    @apply bg-gray-50 text-gray-900 dark:bg-gray-900 dark:text-gray-50;\n  }\n}\n\n### FILE: lib/types.ts\nexport interface Item {\n  id: number;\n  name: string;\n  price: number;\n  quantity: number; // Quantity in cart/order\n  image?: string; // Optional image for products\n}\n\nexport type LoyaltyTier = \"bronze\" | \"silver\" | \"gold\";\n\nexport interface User {\n  id: number;\n  email: string;\n  loyaltyTier: LoyaltyTier;\n  state: string; // For tax calculation\n}\n\nexport interface Order {\n  id: number;\n  items: Item[];\n  user: User;\n  subtotal: number; // Sum of item prices * quantities\n  discount: number; // Loyalty discount applied\n  tax: number; // Tax applied\n  total: number; // Final total\n}\n\nexport interface CartItem extends Item {\n  // CartItem extends Item, adding no new properties but clarifying its use in the cart\n}\n\nexport interface OrderSummary {\n  subtotal: number;\n  discount: number;\n  tax: number;\n  total: number;\n}\n\n### FILE: lib/pricing.ts\nimport { Item, LoyaltyTier, OrderSummary } from './types';\n\n// Tax rates by state (example, based on Python reference concept)\nconst TAX_RATES: { [key: string]: number } = {\n  \"CA\": 0.08, // California\n  \"NY\": 0.07, // New York\n  \"TX\": 0.0625, // Texas\n  \"FL\": 0.06, // Florida\n  \"IL\": 0.0625, // Illinois\n  \"WA\": 0.065, // Washington\n  // Add more states as needed\n};\n\n// Loyalty tier discounts\nconst LOYALTY_DISCOUNTS: { [key in LoyaltyTier]: number } = {\n  \"bronze\": 0.05, // 5% discount\n  \"silver\": 0.10, // 10% discount\n  \"gold\": 0.15, // 15% discount\n};\n\n/**\n * Rounds a number to two decimal places.\n * @param value The number to round.\n * @returns The rounded number.\n */\nfunction roundToTwoDecimals(value: number): number {\n  return parseFloat(value.toFixed(2));\n}\n\n/**\n * Calculates the order total including subtotal, discount, tax, and final total.\n * Translates the logic from the @reference/pricing.py file.\n *\n * @param items A list of items with price and quantity.\n * @param userState The state of the user for tax calculation.\n * @param loyaltyTier The loyalty tier of the user for discount calculation.\n * @returns An object containing subtotal, discount, tax, and total.\n */\nexport function calculateOrderTotals(\n  items: Item[],\n  userState: string,\n  loyaltyTier: LoyaltyTier\n): OrderSummary {\n  let subtotal = items.reduce((sum, item) => sum + item.price * item.quantity, 0);\n  subtotal = roundToTwoDecimals(subtotal);\n\n  // --- Apply Loyalty Discount ---\n  let discountAmount = 0;\n  const discountPercentage = LOYALTY_DISCOUNTS[loyaltyTier] || 0;\n\n  if (subtotal > 0 && discountPercentage > 0) {\n    discountAmount = subtotal * discountPercentage;\n\n    // Business Rule: Minimum order $10 after discounts\n    // If the subtotal is already less than $10, no discount applies.\n    // If applying the full discount makes the subtotal less than $10,\n    // and the original subtotal was >= $10, cap the discount so the post-discount subtotal is $10.\n    const subtotalAfterFullDiscount = subtotal - discountAmount;\n\n    if (subtotal < 10) {\n      discountAmount = 0; // No discount if original subtotal is less than $10\n    } else if (subtotalAfterFullDiscount < 10) {\n      // If original subtotal was >= $10 but full discount makes it < $10,\n      // cap discount so post-discount subtotal is exactly $10.\n      discountAmount = subtotal - 10;\n    }\n  }\n  discountAmount = roundToTwoDecimals(discountAmount);\n\n  const subtotalAfterDiscount = roundToTwoDecimals(subtotal - discountAmount);\n\n  // --- Calculate Tax ---\n  let taxAmount = 0;\n  const taxRate = TAX_RATES[userState.toUpperCase()] || 0; // Default to 0 if state not found\n\n  // Tax is calculated on (subtotal - discount)\n  taxAmount = subtotalAfterDiscount * taxRate;\n  taxAmount = roundToTwoDecimals(taxAmount); // Store tax separately, rounded\n\n  // --- Calculate Total ---\n  const total = roundToTwoDecimals(subtotalAfterDiscount + taxAmount);\n\n  return {\n    subtotal,\n    discount: discountAmount,\n    tax: taxAmount,\n    total,\n  };\n}\n\n### FILE: lib/utils.ts\n/**\n * Formats a number as a currency string (e.g., $12.34).\n * @param amount The number to format.\n * @param currency The currency code (default: 'USD').\n * @param locale The locale (default: 'en-US').\n * @returns The formatted currency string.\n */\nexport function formatCurrency(amount: number, currency: string = 'USD', locale: string = 'en-US'): string {\n  return new Intl.NumberFormat(locale, {\n    style: 'currency',\n    currency: currency,\n  }).format(amount);\n}\n\n### FILE: data/products.ts\nimport { Item } from '@/lib/types';\n\nexport const products: Item[] = [\n  { id: 1, name: 'Wireless Headphones', price: 99.99, quantity: 1, image: '/images/headphones.jpg' },\n  { id: 2, name: 'Smartwatch', price: 199.99, quantity: 1, image: '/images/smartwatch.jpg' },\n  { id: 3, name: 'Portable Bluetooth Speaker', price: 79.99, quantity: 1, image: '/images/speaker.jpg' },\n  { id: 4, name: 'Ergonomic Office Chair', price: 249.99, quantity: 1, image: '/images/chair.jpg' },\n  { id: 5, name: '4K UHD Monitor', price: 349.99, quantity: 1, image: '/images/monitor.jpg' },\n  { id: 6, name: 'Mechanical Keyboard', price: 129.99, quantity: 1, image: '/images/keyboard.jpg' },\n];\n\n### FILE: data/mockUser.ts\nimport { User } from '@/lib/types';\n\nexport const mockUser: User = {\n  id: 1,\n  email: 'john.doe@example.com',\n  loyaltyTier: 'silver', // Can be 'bronze', 'silver', 'gold'\n  state: 'CA', // For tax calculation\n};\n\n### FILE: components/ThemeProvider.tsx\n'use client';\n\nimport { ThemeProvider as NextThemesProvider } from 'next-themes';\nimport { type ThemeProviderProps } from 'next-themes/dist/types';\nimport * as React from 'react';\n\nexport function ThemeProvider({ children, ...props }: ThemeProviderProps) {\n  return <NextThemesProvider {...props}>{children}</NextThemesProvider>;\n}\n\n### FILE: components/DarkModeToggle.tsx\n'use client';\n\nimport { useTheme } from 'next-themes';\nimport { useEffect, useState } from 'react';\n\nexport function DarkModeToggle() {\n  const [mounted, setMounted] = useState(false);\n  const { theme, setTheme } = useTheme();\n\n  // useEffect only runs on the client, so now we can safely show the UI\n  useEffect(() => {\n    setMounted(true);\n  }, []);\n\n  if (!mounted) {\n    return null;\n  }\n\n  return (\n    <button\n      onClick={() => setTheme(theme === 'dark' ? 'light' : 'dark')}\n      className=\"p-2 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors duration-200\"\n      aria-label=\"Toggle dark mode\"\n    >\n      {theme === 'dark' ? (\n        <svg\n          xmlns=\"http://www.w3.org/2000/svg\"\n          className=\"h-5 w-5\"\n          viewBox=\"0 0 20 20\"\n          fill=\"currentColor\"\n        >\n          <path d=\"M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z\" />\n        </svg>\n      ) : (\n        <svg\n          xmlns=\"http://www.w3.org/2000/svg\"\n          className=\"h-5 w-5\"\n          viewBox=\"0 0 20 20\"\n          fill=\"currentColor\"\n        >\n          <path\n            fillRule=\"evenodd\"\n            d=\"M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.459 4.581A1 1 0 0113 15h-2a1 1 0 110-2h2a1 1 0 01.459.081zm-2.004-7.582a1 1 0 01.083-.459l.707-.707a1 1 0 011.414 1.414l-.707.707a1 1 0 01-.459.083zM10 18a1 1 0 01-1-1v-1a1 1 0 112 0v1a1 1 0 01-1 1zm-4-8a4 4 0 11-8 0 4 4 0 018 0zm-.459-4.581A1 1 0 017 5h2a1 1 0 110 2H7a1 1 0 01-.459-.081z\"\n            clipRule=\"evenodd\"\n          />\n        </svg>\n      )}\n    </button>\n  );\n}\n\n### FILE: components/Navbar.tsx\nimport Link from 'next/link';\nimport { DarkModeToggle } from './DarkModeToggle';\nimport { useCart } from '@/context/CartContext';\n\nexport function Navbar() {\n  const { cartItems } = useCart();\n  const totalItems = cartItems.reduce((sum, item) => sum + item.quantity, 0);\n\n  return (\n    <nav className=\"bg-white dark:bg-gray-800 shadow-md p-4 sticky top-0 z-50\">\n      <div className=\"container mx-auto flex justify-between items-center\">\n        <Link href=\"/\" className=\"text-2xl font-bold text-gray-800 dark:text-white hover:text-blue-600 dark:hover:text-blue-400 transition-colors duration-200\">\n          my shop\n        </Link>\n        <div className=\"flex items-center space-x-4\">\n          <DarkModeToggle />\n          <Link href=\"/cart\" className=\"relative p-2 rounded-md bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors duration-200\">\n            <svg\n              xmlns=\"http://www.w3.org/2000/svg\"\n              className=\"h-6 w-6 text-gray-700 dark:text-gray-200\"\n              fill=\"none\"\n              viewBox=\"0 0 24 24\"\n              stroke=\"currentColor\"\n            >\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                strokeWidth={2}\n                d=\"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z\"\n              />\n            </svg>\n            {totalItems > 0 && (\n              <span className=\"absolute -top-1 -right-1 bg-red-500 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center\">\n                {totalItems}\n              </span>\n            )}\n          </Link>\n        </div>\n      </div>\n    </nav>\n  );\n}\n\n### FILE: components/ProductCard.tsx\nimport Image from 'next/image';\nimport { Item } from '@/lib/types';\nimport { formatCurrency } from '@/lib/utils';\nimport { useCart } from '@/context/CartContext';\n\ninterface ProductCardProps {\n  product: Item;\n}\n\nexport function ProductCard({ product }: ProductCardProps) {\n  const { addItem } = useCart();\n\n  return (\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow duration-300\">\n      <div className=\"relative w-full h-48 bg-gray-200 dark:bg-gray-700 flex items-center justify-center\">\n        {product.image ? (\n          <Image\n            src={product.image}\n            alt={product.name}\n            fill\n            style={{ objectFit: 'cover' }}\n            className=\"transition-transform duration-300 hover:scale-105\"\n            sizes=\"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw\"\n          />\n        ) : (\n          <span className=\"text-gray-500 dark:text-gray-400 text-sm\">No Image</span>\n        )}\n      </div>\n      <div className=\"p-4\">\n        <h3 className=\"text-lg font-semibold text-gray-800 dark:text-white mb-2\">{product.name}</h3>\n        <p className=\"text-xl font-bold text-gray-900 dark:text-gray-100 mb-4\">{formatCurrency(product.price)}</p>\n        <button\n          onClick={() => addItem(product)}\n          className=\"w-full bg-black text-white py-2 px-4 rounded-md hover:bg-gray-800 dark:hover:bg-gray-700 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-black focus:ring-opacity-50\"\n        >\n          Add to Cart\n        </button>\n      </div>\n    </div>\n  );\n}\n\n### FILE: components/CartItem.tsx\nimport Image from 'next/image';\nimport { CartItem } from '@/lib/types';\nimport { formatCurrency } from '@/lib/utils';\nimport { useCart } from '@/context/CartContext';\n\ninterface CartItemProps {\n  item: CartItem;\n}\n\nexport function CartItemComponent({ item }: CartItemProps) {\n  const { updateQuantity, removeItem } = useCart();\n\n  return (\n    <div className=\"flex items-center justify-between bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm mb-4\">\n      <div className=\"flex items-center space-x-4\">\n        <div className=\"relative w-20 h-20 bg-gray-100 dark:bg-gray-700 rounded-md overflow-hidden\">\n          {item.image ? (\n            <Image\n              src={item.image}\n              alt={item.name}\n              fill\n              style={{ objectFit: 'cover' }}\n              sizes=\"80px\"\n            />\n          ) : (\n            <div className=\"flex items-center justify-center w-full h-full text-gray-500 dark:text-gray-400 text-xs\">No Image</div>\n          )}\n        </div>\n        <div>\n          <h3 className=\"font-semibold text-gray-800 dark:text-white\">{item.name}</h3>\n          <p className=\"text-gray-600 dark:text-gray-300\">{formatCurrency(item.price)}</p>\n        </div>\n      </div>\n      <div className=\"flex items-center space-x-4\">\n        <div className=\"flex items-center border border-gray-300 dark:border-gray-600 rounded-md\">\n          <button\n            onClick={() => updateQuantity(item.id, item.quantity - 1)}\n            disabled={item.quantity <= 1}\n            className=\"p-2 text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50 transition-colors duration-200\"\n          >\n            -\n          </button>\n          <span className=\"px-3 text-gray-800 dark:text-white\">{item.quantity}</span>\n          <button\n            onClick={() => updateQuantity(item.id, item.quantity + 1)}\n            className=\"p-2 text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200\"\n          >\n            +\n          </button>\n        </div>\n        <button\n          onClick={() => removeItem(item.id)}\n          className=\"text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-500 transition-colors duration-200\"\n          aria-label={`Remove ${item.name}`}\n        >\n          <svg\n            xmlns=\"http://www.w3.org/2000/svg\"\n            className=\"h-6 w-6\"\n            fill=\"none\"\n            viewBox=\"0 0 24 24\"\n            stroke=\"currentColor\"\n          >\n            <path\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n              strokeWidth={2}\n              d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\"\n            />\n          </svg>\n        </button>\n      </div>\n    </div>\n  );\n}\n\n### FILE: components/CheckoutSummary.tsx\nimport { formatCurrency } from '@/lib/utils';\nimport { OrderSummary } from '@/lib/types';\n\ninterface CheckoutSummaryProps {\n  summary: OrderSummary;\n}\n\nexport function CheckoutSummary({ summary }: CheckoutSummaryProps) {\n  return (\n    <div className=\"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md\">\n      <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white mb-4\">Order Summary</h2>\n      <div className=\"space-y-2 text-gray-700 dark:text-gray-300\">\n        <div className=\"flex justify-between\">\n          <span>Subtotal:</span>\n          <span>{formatCurrency(summary.subtotal)}</span>\n        </div>\n        <div className=\"flex justify-between\">\n          <span>Discount:</span>\n          <span className=\"text-red-500\">- {formatCurrency(summary.discount)}</span>\n        </div>\n        <div className=\"flex justify-between\">\n          <span>Tax:</span>\n          <span>{formatCurrency(summary.tax)}</span>\n        </div>\n        <div className=\"border-t border-gray-200 dark:border-gray-700 pt-4 mt-4 flex justify-between text-xl font-bold text-gray-900 dark:text-white\">\n          <span>Total:</span>\n          <span>{formatCurrency(summary.total)}</span>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n### FILE: context/CartContext.tsx\n'use client';\n\nimport React, { createContext, useContext, useState, useEffect, ReactNode, useCallback } from 'react';\nimport { CartItem, Item, LoyaltyTier, OrderSummary } from '@/lib/types';\nimport { calculateOrderTotals } from '@/lib/pricing';\nimport { mockUser } from '@/data/mockUser'; // Assuming a mock user for calculations\n\ninterface CartContextType {\n  cartItems: CartItem[];\n  addItem: (item: Item) => void;\n  updateQuantity: (itemId: number, quantity: number) => void;\n  removeItem: (itemId: number) => void;\n  clearCart: () => void;\n  orderSummary: OrderSummary;\n  isLoading: boolean;\n}\n\nconst CartContext = createContext<CartContextType | undefined>(undefined);\n\nexport function CartProvider({ children }: { children: ReactNode }) {\n  const [cartItems, setCartItems] = useState<CartItem[]>([]);\n  const [orderSummary, setOrderSummary] = useState<OrderSummary>({\n    subtotal: 0,\n    discount: 0,\n    tax: 0,\n    total: 0,\n  });\n  const [isLoading, setIsLoading] = useState(true);\n\n  // Load cart from localStorage on initial mount\n  useEffect(() => {\n    const storedCart = localStorage.getItem('myShopCart');\n    if (storedCart) {\n      setCartItems(JSON.parse(storedCart));\n    }\n    setIsLoading(false);\n  }, []);\n\n  // Save cart to localStorage whenever it changes\n  useEffect(() => {\n    if (!isLoading) { // Only save after initial load to prevent overwriting\n      localStorage.setItem('myShopCart', JSON.stringify(cartItems));\n    }\n  }, [cartItems, isLoading]);\n\n  // Recalculate order summary whenever cart items change\n  useEffect(() => {\n    const summary = calculateOrderTotals(\n      cartItems,\n      mockUser.state, // Use mock user's state for tax\n      mockUser.loyaltyTier // Use mock user's loyalty tier for discount\n    );\n    setOrderSummary(summary);\n  }, [cartItems]);\n\n  const addItem = useCallback((item: Item) => {\n    setCartItems((prevItems) => {\n      const existingItem = prevItems.find((cartItem) => cartItem.id === item.id);\n      if (existingItem) {\n        return prevItems.map((cartItem) =>\n          cartItem.id === item.id\n            ? { ...cartItem, quantity: cartItem.quantity + 1 }\n            : cartItem\n        );\n      } else {\n        return [...prevItems, { ...item, quantity: 1 }];\n      }\n    });\n  }, []);\n\n  const updateQuantity = useCallback((itemId: number, quantity: number) => {\n    setCartItems((prevItems) => {\n      if (quantity <= 0) {\n        return prevItems.filter((item) => item.id !== itemId);\n      }\n      return prevItems.map((item) =>\n        item.id === itemId ? { ...item, quantity } : item\n      );\n    });\n  }, []);\n\n  const removeItem = useCallback((itemId: number) => {\n    setCartItems((prevItems) => prevItems.filter((item) => item.id !== itemId));\n  }, []);\n\n  const clearCart = useCallback(() => {\n    setCartItems([]);\n  }, []);\n\n  const value = {\n    cartItems,\n    addItem,\n    updateQuantity,\n    removeItem,\n    clearCart,\n    orderSummary,\n    isLoading,\n  };\n\n  return <CartContext.Provider value={value}>{children}</CartContext.Provider>;\n}\n\nexport function useCart() {\n  const context = useContext(CartContext);\n  if (context === undefined) {\n    // This is the fix for \"Error: useCart must be used within a CartProvider\"\n    throw new Error('useCart must be used within a CartProvider');\n  }\n  return context;\n}\n\n### FILE: app/layout.tsx\nimport type { Metadata } from 'next';\nimport { Inter } from 'next/font/google';\nimport './globals.css';\nimport { ThemeProvider } from '@/components/ThemeProvider';\nimport { Navbar } from '@/components/Navbar';\nimport { CartProvider } from '@/context/CartContext';\n\nconst inter = Inter({ subsets: ['latin'] });\n\nexport const metadata: Metadata = {\n  title: 'my shop',\n  description: 'A modern e-commerce shop built with Next.js and Tailwind CSS',\n};\n\nexport default function RootLayout({\n  children,\n}: Readonly<{\n  children: React.ReactNode;\n}>) {\n  return (\n    <html lang=\"en\" suppressHydrationWarning>\n      <body className={inter.className}>\n        <ThemeProvider attribute=\"class\" defaultTheme=\"system\" enableSystem>\n          <CartProvider>\n            <Navbar />\n            <main className=\"container mx-auto p-4 min-h-[calc(100vh-64px)]\">\n              {children}\n            </main>\n            {/* Optional: Add a footer here */}\n            <footer className=\"bg-gray-100 dark:bg-gray-800 text-center p-4 text-gray-600 dark:text-gray-400 mt-8\">\n              &copy; {new Date().getFullYear()} my shop. All rights reserved.\n            </footer>\n          </CartProvider>\n        </ThemeProvider>\n      </body>\n    </html>\n  );\n}\n\n### FILE: app/page.tsx\nimport { ProductCard } from '@/components/ProductCard';\nimport { products } from '@/data/products';\n\nexport default function Home() {\n  return (\n    <div className=\"py-8\">\n      <h1 className=\"text-4xl font-extrabold text-center text-gray-900 dark:text-white mb-10\">\n        Welcome to my shop!\n      </h1>\n      <div className=\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6\">\n        {products.map((product) => (\n          <ProductCard key={product.id} product={product} />\n        ))}\n      </div>\n    </div>\n  );\n}\n\n### FILE: app/cart/page.tsx\n'use client';\n\nimport Link from 'next/link';\nimport { useCart } from '@/context/CartContext';\nimport { CartItemComponent } from '@/components/CartItem';\nimport { CheckoutSummary } from '@/components/CheckoutSummary';\nimport { formatCurrency } from '@/lib/utils';\n\nexport default function CartPage() {\n  const { cartItems, orderSummary, isLoading } = useCart();\n\n  if (isLoading) {\n    return (\n      <div className=\"text-center py-10 text-gray-700 dark:text-gray-300\">\n        Loading cart...\n      </div>\n    );\n  }\n\n  if (cartItems.length === 0) {\n    return (\n      <div className=\"text-center py-10\">\n        <h1 className=\"text-3xl font-bold text-gray-900 dark:text-white mb-4\">\n          Your cart is empty.\n        </h1>\n        <p className=\"text-lg text-gray-700 dark:text-gray-300 mb-6\">\n          Looks like you haven&apos;t added anything to your cart yet.\n        </p>\n        <Link\n          href=\"/\"\n          className=\"inline-block bg-blue-600 text-white py-3 px-6 rounded-md text-lg font-semibold hover:bg-blue-700 transition-colors duration-200\"\n        >\n          Start Shopping\n        </Link>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"py-8\">\n      <h1 className=\"text-4xl font-extrabold text-gray-900 dark:text-white mb-8\">\n        Your Shopping Cart\n      </h1>\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n        <div className=\"lg:col-span-2\">\n          <div className=\"space-y-4\">\n            {cartItems.map((item) => (\n              <CartItemComponent key={item.id} item={item} />\n            ))}\n          </div>\n        </div>\n        <div className=\"lg:col-span-1\">\n          <CheckoutSummary summary={orderSummary} />\n          <Link\n            href=\"/checkout\"\n            className=\"mt-6 w-full block text-center bg-green-600 text-white py-3 px-6 rounded-md text-lg font-semibold hover:bg-green-700 transition-colors duration-200\"\n          >\n            Proceed to Checkout\n          </Link>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n### FILE: app/checkout/page.tsx\n'use client';\n\nimport { useCart } from '@/context/CartContext';\nimport { CheckoutSummary } from '@/components/CheckoutSummary';\nimport { mockUser } from '@/data/mockUser';\nimport { formatCurrency } from '@/lib/utils';\nimport { useRouter } from 'next/navigation';\nimport { useEffect, useState } from 'react';\n\nexport default function CheckoutPage() {\n  const { cartItems, orderSummary, clearCart, isLoading } = useCart();\n  const router = useRouter();\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [paymentSuccess, setPaymentSuccess] = useState(false);\n\n  useEffect(() => {\n    if (!isLoading && cartItems.length === 0 && !paymentSuccess) {\n      router.push('/'); // Redirect to home if cart is empty and not just completed payment\n    }\n  }, [cartItems, isLoading, paymentSuccess, router]);\n\n  const handleProcessPayment = async () => {\n    setIsProcessing(true);\n    // Simulate payment processing\n    await new Promise((resolve) => setTimeout(resolve, 2000));\n\n    // In a real application, you would send order details to a backend\n    // and handle payment gateway integration here.\n    console.log('Processing payment for:', {\n      items: cartItems,\n      user: mockUser,\n      orderSummary,\n    });\n\n    // Simulate success\n    setPaymentSuccess(true);\n    clearCart(); // Clear cart after successful payment\n    setIsProcessing(false);\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"text-center py-10 text-gray-700 dark:text-gray-300\">\n        Loading checkout details...\n      </div>\n    );\n  }\n\n  if (cartItems.length === 0 && !paymentSuccess) {\n    return null; // Redirect handled by useEffect\n  }\n\n  if (paymentSuccess) {\n    return (\n      <div className=\"text-center py-10\">\n        <h1 className=\"text-4xl font-bold text-green-600 dark:text-green-400 mb-4\">\n          Order Confirmed!\n        </h1>\n        <p className=\"text-xl text-gray-700 dark:text-gray-300 mb-6\">\n          Thank you for your purchase, {mockUser.email}!\n        </p>\n        <p className=\"text-lg text-gray-700 dark:text-gray-300 mb-8\">\n          Your order total was {formatCurrency(orderSummary.total)}. A confirmation email has been sent.\n        </p>\n        <button\n          onClick={() => router.push('/')}\n          className=\"inline-block bg-blue-600 text-white py-3 px-6 rounded-md text-lg font-semibold hover:bg-blue-700 transition-colors duration-200\"\n        >\n          Continue Shopping\n        </button>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"py-8\">\n      <h1 className=\"text-4xl font-extrabold text-gray-900 dark:text-white mb-8\">\n        Checkout\n      </h1>\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8\">\n        <div>\n          <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white mb-4\">\n            Shipping Information\n          </h2>\n          <div className=\"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md mb-6\">\n            <p className=\"text-gray-700 dark:text-gray-300\">\n              Email: <span className=\"font-semibold\">{mockUser.email}</span>\n            </p>\n            <p className=\"text-gray-700 dark:text-gray-300\">\n              Loyalty Tier: <span className=\"font-semibold capitalize\">{mockUser.loyaltyTier}</span>\n            </p>\n            <p className=\"text-gray-700 dark:text-gray-300\">\n              Shipping Address: <span className=\"font-semibold\">123 Main St, {mockUser.state}, 90210</span> (Mock)\n            </p>\n          </div>\n\n          <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white mb-4\">\n            Payment Method\n          </h2>\n          <div className=\"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md\">\n            <p className=\"text-gray-700 dark:text-gray-300\">\n              Credit Card: **** **** **** 1234 (Mock)\n            </p>\n            <p className=\"text-gray-700 dark:text-gray-300\">\n              Expiry: 12/25 (Mock)\n            </p>\n          </div>\n        </div>\n        <div>\n          <CheckoutSummary summary={orderSummary} />\n          <button\n            onClick={handleProcessPayment}\n            disabled={isProcessing}\n            className=\"mt-6 w-full block text-center bg-blue-600 text-white py-3 px-6 rounded-md text-lg font-semibold hover:bg-blue-700 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed\"\n          >\n            {isProcessing ? 'Processing Payment...' : `Pay ${formatCurrency(orderSummary.total)}`}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n### FILE: public/images/headphones.jpg\n(Binary content: A placeholder image for headphones. In a real scenario, this would be a actual image file.)\n\n### FILE: public/images/smartwatch.jpg\n(Binary content: A placeholder image for a smartwatch. In a real scenario, this would be a actual image file.)\n\n### FILE: public/images/speaker.jpg\n(Binary content: A placeholder image for a speaker. In a real scenario, this would be a actual image file.)\n\n### FILE: public/images/chair.jpg\n(Binary content: A placeholder image for a chair. In a real scenario, this would be a actual image file.)\n\n### FILE: public/images/monitor.jpg\n(Binary content: A placeholder image for a monitor. In a real scenario, this would be a actual image file.)\n\n### FILE: public/images/keyboard.jpg\n(Binary content: A placeholder image for a keyboard. In a real scenario, this would be a actual image file.)",
  "ca124498362453191611f131d7cb6ba4da0c9ee63b350fa9678036b84f4c99db": "### FILE: lib/pricing.ts\n// Data Models (as provided in the prompt)\ninterface Item {\n  id: number;\n  name: string;\n  price: number;\n  quantity: number;\n}\n\ninterface User {\n  id: number;\n  email: string;\n  loyaltyTier: \"bronze\" | \"silver\" | \"gold\";\n  state: string;\n}\n\ninterface Order {\n  id?: number; // Order ID might be generated later, or passed in for existing orders\n  items: Item[];\n  user: User;\n  subtotal: number;\n  discount: number;\n  tax: number;\n  total: number;\n}\n\n// Helper for rounding to 2 decimal places\nconst roundToTwoDecimals = (num: number): number => {\n  return Math.round(num * 100) / 100;\n};\n\n// Tax rates (inferred from common practice, as @reference/pricing.py is not provided)\nconst TAX_RATES: { [key: string]: number } = {\n  CA: 0.0825, // California\n  NY: 0.0400, // New York\n  TX: 0.0625, // Texas\n  FL: 0.0600, // Florida\n  // Add more states as needed\n  DEFAULT: 0.0500, // Default tax rate\n};\n\n/**\n * Calculates the discount amount based on loyalty tier and subtotal.\n * Applies discounts before tax calculation.\n * Rounds to 2 decimal places.\n * Minimum order $10 after discounts: If the subtotal is less than $10, no discount is applied.\n * If the subtotal is $10 or more, apply the discount, but the final discounted amount cannot be less than $10.\n *\n * @param subtotal The calculated subtotal before any discounts.\n * @param user The user object with loyalty tier.\n * @returns The calculated discount amount.\n */\nexport const applyDiscount = (subtotal: number, user: User): number => {\n  let discountRate = 0;\n\n  switch (user.loyaltyTier) {\n    case \"silver\":\n      discountRate = 0.05; // 5% discount\n      break;\n    case \"gold\":\n      discountRate = 0.10; // 10% discount\n      break;\n    case \"bronze\":\n    default:\n      discountRate = 0; // No discount for bronze or unknown tiers\n      break;\n  }\n\n  // No discount if subtotal is less than $10\n  if (subtotal < 10) {\n    return 0;\n  }\n\n  let discountAmount = subtotal * discountRate;\n\n  // Ensure the subtotal after discount is not less than $10\n  // This means the discount cannot push the subtotal below $10\n  if (subtotal - discountAmount < 10) {\n    discountAmount = subtotal - 10; // Cap the discount so remaining subtotal is exactly $10\n    if (discountAmount < 0) { // Should not happen if subtotal >= 10 and discountRate >= 0\n        discountAmount = 0;\n    }\n  }\n\n  return roundToTwoDecimals(discountAmount);\n};\n\n/**\n * Calculates the total price for an order, including subtotal, discount, tax, and final total.\n *\n * @param items A list of items in the order.\n * @param user The user placing the order.\n * @returns An object containing subtotal, discount, tax, and total.\n */\nexport const calculateOrderTotal = (items: Item[], user: User): Omit<Order, 'id' | 'items' | 'user'> => {\n  let subtotal = 0;\n  for (const item of items) {\n    subtotal += item.price * item.quantity;\n  }\n  subtotal = roundToTwoDecimals(subtotal);\n\n  const discount = applyDiscount(subtotal, user);\n\n  const subtotalAfterDiscount = subtotal - discount;\n\n  // Get tax rate for the user's state, or use default\n  const taxRate = TAX_RATES[user.state.toUpperCase()] || TAX_RATES.DEFAULT;\n\n  // Calculate tax on (subtotal - discount)\n  const tax = roundToTwoDecimals(subtotalAfterDiscount * taxRate);\n\n  const total = roundToTwoDecimals(subtotalAfterDiscount + tax);\n\n  return {\n    subtotal,\n    discount,\n    tax,\n    total,\n  };\n};\n\n// Export types for external use if needed\nexport type { Item, User, Order };",
  "1f8592475fc5acbbc46587c0fd4a2796b5790da5adc966d252591c4803a674df": "### FILE: lib/pricing.ts\n// Data Models (as interfaces, assuming they are not globally available or imported from a common types file)\ninterface Item {\n  id: number;\n  name: string;\n  price: number;\n  quantity: number;\n}\n\ninterface User {\n  id: number;\n  email: string;\n  loyaltyTier: \"bronze\" | \"silver\" | \"gold\";\n  state: string;\n}\n\n// Return type for calculateTotal\ninterface OrderSummary {\n  subtotal: number;\n  discount: number;\n  tax: number;\n  total: number;\n}\n\n/**\n * Calculates the order total with all business rules applied.\n *\n * @param items List of items with price and quantity.\n * @param user User details including loyalty tier and state.\n * @param taxRate Optional tax rate override.\n * @returns An object containing subtotal, discount, tax, and total.\n */\nexport function calculateTotal(\n  items: Item[],\n  user: User,\n  taxRate: number | null = null\n): OrderSummary {\n  // Calculate subtotal\n  const subtotal = items.reduce((sum, item) => sum + item.price * item.quantity, 0);\n\n  // Apply volume discount (10+ items = 10% off)\n  let volumeDiscount = 0;\n  const totalItems = items.reduce((sum, item) => sum + item.quantity, 0);\n  if (totalItems >= 10) {\n    volumeDiscount = subtotal * 0.10;\n  }\n\n  // Apply loyalty tier discount\n  const tierDiscounts: { [key in User['loyaltyTier']]: number } = {\n    'bronze': 0.05, // 5%\n    'silver': 0.10, // 10%\n    'gold': 0.15    // 15%\n  };\n  // Use 0 if loyaltyTier is not found in tierDiscounts (e.g., for new tiers or undefined)\n  const loyaltyDiscount = subtotal * (tierDiscounts[user.loyaltyTier] || 0);\n\n  // Total discount\n  const totalDiscount = volumeDiscount + loyaltyDiscount;\n\n  // Calculate tax\n  let effectiveTaxRate = taxRate;\n  if (effectiveTaxRate === null) {\n    // State-specific tax rates\n    effectiveTaxRate = user.state === 'CA' ? 0.08 : 0.05;\n  }\n\n  const taxableAmount = subtotal - totalDiscount;\n  const tax = taxableAmount * effectiveTaxRate;\n\n  // Final total\n  const total = subtotal - totalDiscount + tax;\n\n  return {\n    subtotal: parseFloat(subtotal.toFixed(2)),\n    discount: parseFloat(totalDiscount.toFixed(2)),\n    tax: parseFloat(tax.toFixed(2)),\n    total: parseFloat(total.toFixed(2))\n  };\n}\n\n/**\n * Applies a percentage discount to an amount.\n *\n * @param amount Original amount.\n * @param discountPercent Discount as percentage (e.g., 10 for 10%).\n * @returns Discounted amount rounded to 2 decimal places.\n */\nexport function applyDiscount(amount: number, discountPercent: number): number {\n  const discount = amount * (discountPercent / 100);\n  return parseFloat((amount - discount).toFixed(2));\n}\n\n/**\n * Validates if an order meets a minimum requirement.\n *\n * @param orderTotal Total order amount.\n * @param minimum Minimum order amount (default $10).\n * @returns True if valid, False otherwise.\n */\nexport function validateOrder(orderTotal: number, minimum: number = 10.00): boolean {\n  return orderTotal >= minimum;\n}"
}